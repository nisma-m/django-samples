{% extends 'base.html' %}
{% block title %}PDF Library{% endblock %}
{% block content %}
<h1 class="mb-4 d-flex justify-content-between align-items-center">
  ğŸ“š Uploaded PDFs
  <a href="{% url 'book_list' %}" class="btn btn-outline-secondary btn-sm">â†© Back to Book List</a>
</h1>

{% if messages %}
  {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  {% endfor %}
{% endif %}


<form method="get" class="mb-3">
  <input type="text" name="q" class="form-control" placeholder="ğŸ” Search by title or author" value="{{ request.GET.q }}">
</form>

<div class="card p-4">
  <table class="table table-hover">
    <thead class="table-light">
      <tr>
        <th>ğŸ“„ Title</th>
        <th>ğŸ‘¤ Author</th>
        <th>ğŸ“… Uploaded At</th>
        <th>ğŸ“¦ Size</th>
        <th>ğŸ”— Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for pdf in pdfs %}
      <tr>
        <td>{{ pdf.title }}</td>
        <td>{{ pdf.author }}</td>
        <td>{{ pdf.uploaded_at|date:"Y-m-d H:i" }}</td>
        <td>
          {% with pdf.pdf_file.size|filesizeformat as size %}
            {{ size }}
          {% endwith %}
        </td>
        <td>
          <a href="{{ pdf.pdf_file.url }}" class="btn btn-sm btn-info" target="_blank">ğŸ“– View</a>
          <!-- <a href="{{ pdf.pdf_file.url }}" class="btn btn-sm btn-success" download>â¬‡ï¸ Download</a> -->
          <a href="{% url 'download_pdf' pdf.id %}" class="btn btn-sm btn-success">â¬‡ï¸ Download</a>
          <a href="{% url 'pdf_delete' pdf.id %}" class="btn btn-sm btn-danger">ğŸ—‘ï¸ Delete</a>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="5" class="text-center">ğŸ˜• No PDFs uploaded.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
